<Window x:Class="UWUVCI_AIO_WPF.UI.Windows.ApplicationSettings"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Application Settings"
        Height="440" Width="725"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Background="#FFF3F3F3">

    <Window.Resources>
        <!-- Buttons -->
        <Style TargetType="Button">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="Margin" Value="6,0,0,0"/>
            <Setter Property="MinWidth" Value="100"/>
            <Setter Property="Background" Value="#FF2196F3"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="4" SnapsToDevicePixels="True">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"
                                              Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#FF42A5F5"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#FF1E88E5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SecondaryButton" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Background" Value="#FF757575"/>
        </Style>

        <!-- TextBox -->
        <Style TargetType="TextBox">
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="BorderBrush" Value="#CCC"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="4"/>
            <Style.Triggers>
                <Trigger Property="IsKeyboardFocused" Value="True">
                    <Setter Property="BorderBrush" Value="#FF2196F3"/>
                    <Setter Property="BorderThickness" Value="1.5"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Border CornerRadius="6" Background="White" Padding="20" Margin="16">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <TextBlock FontSize="20" FontWeight="Bold" Text="Application Settings" Margin="0,0,0,12"/>

            <StackPanel Grid.Row="1" Orientation="Vertical" Margin="0,8,0,0">
                <!-- Base Path -->
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,0,6">
                    <TextBlock Width="150" VerticalAlignment="Center" Text="Base Path:"/>
                    <TextBox Width="380" Text="{Binding BasePath, UpdateSourceTrigger=PropertyChanged}"/>
                    <Button Content="Browse…" Command="{Binding BrowseBasePathCommand}"/>
                </StackPanel>

                <!-- Output Path -->
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,0,6">
                    <TextBlock Width="150" VerticalAlignment="Center" Text="Output Path:"/>
                    <TextBox Width="380" Text="{Binding OutPath, UpdateSourceTrigger=PropertyChanged}"/>
                    <Button Content="Browse…" Command="{Binding BrowseOutPathCommand}"/>
                </StackPanel>

                <Separator Margin="0,10,0,10"/>

                <!-- Common Key (inline show/hide) -->
                <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                    <TextBlock Width="150" VerticalAlignment="Center" Text="Common Key (ckey):"/>
                    <Grid Width="380">
                        <!-- Hidden mode -->
                        <PasswordBox x:Name="CkeyBox"
                                     PasswordChanged="CkeyBox_OnPasswordChanged"
                                     Visibility="Visible"/>
                        <!-- Visible mode -->
                        <TextBox x:Name="CkeyPlain"
                                 Visibility="Collapsed"
                                 TextChanged="CkeyPlain_OnTextChanged"
                                 FontFamily="Consolas"
                                 />
                    </Grid>
                    <Button x:Name="BtnShowCkey" Content="Show" Width="80" Click="ToggleCkeyVisibility"/>
                </StackPanel>

                <!-- Ancast Key (inline show/hide) -->
                <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                    <TextBlock Width="150" VerticalAlignment="Center" Text="Ancast Key:"/>
                    <Grid Width="380">
                        <PasswordBox x:Name="AncastBox"
                                     PasswordChanged="AncastBox_OnPasswordChanged"
                                     Visibility="Visible"/>
                        <TextBox x:Name="AncastPlain"
                                 Visibility="Collapsed"
                                 TextChanged="AncastPlain_OnTextChanged"
                                 FontFamily="Consolas"
                                 />
                    </Grid>
                    <Button x:Name="BtnShowAncast" Content="Show" Width="80" Click="ToggleAncastVisibility"/>
                </StackPanel>

                <StackPanel Orientation="Horizontal" Height="38">
                    <CheckBox IsChecked="{Binding SetBaseOnce}" Content="Remember base path" Margin="0,0,18,0"/>
                    <CheckBox IsChecked="{Binding SetOutOnce}" Content="Remember output path"/>
                </StackPanel>

                <!-- Actions -->
                <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                    <Button Content="Reset to Defaults" Command="{Binding ResetToDefaultsCommand}"/>
                    <Button Content="Open Settings File" Command="{Binding OpenSettingsFileCommand}"/>
                    <Button Content="Open Base Folder" Command="{Binding OpenBaseFolderCommand}"/>
                    <Button Content="Open Output Folder" Command="{Binding OpenOutFolderCommand}"/>
                </StackPanel>
            </StackPanel>

            <!-- Bottom Buttons -->
            <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,12,0,0">
                <Button Width="90" Content="Cancel" IsCancel="True" Style="{StaticResource SecondaryButton}"/>
                <Button Width="90" Content="Save" IsDefault="True" Command="{Binding SaveCommand}"/>
            </StackPanel>

            <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,12,0,0">
                <Button Width="150" Content="Open Log Folder" Command="{Binding OpenLogFolderCommand}"/>
            </StackPanel>
        </Grid>
    </Border>
</Window>
